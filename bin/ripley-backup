#!/bin/bash

set -o pipefail

SOURCE1=~/srv/storage/wd-white-8tb/*
SOURCE2=~/srv/services
DESTINATION=~/srv/storage/seagate-red-8tb
LOG_FILE=$DESTINATION/backup.log


function main() {
    time {
        date
        echo ""

        set -x

        rsync --recursive --delete --update --verbose \
            $SOURCE1 $SOURCE2 $DESTINATION
    }
}


if [ "$1" == "main" ]; then
    main
else
    $0 main 2>&1 | cat > $LOG_FILE
fi
